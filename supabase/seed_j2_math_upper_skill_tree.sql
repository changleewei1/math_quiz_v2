-- 國二數學上學期：章節與題型（依技能樹建立）
-- 章節 ID 規則：m2-{章}-{節}
-- 題型 ID 規則：{chapter_id}-{序號}（序號對應 S01=1, S02=2...）
-- 題型代碼：S01, S02, ...

-- 1) 章節
INSERT INTO chapters (id, title, sort_order, is_active, grade_id, term)
VALUES
  ('m2-1-1', '乘法公式', 1, true, 'J2-MATH', 'upper'),
  ('m2-1-2', '多項式與其加減運算', 2, true, 'J2-MATH', 'upper'),
  ('m2-1-3', '單項式的乘除運算', 3, true, 'J2-MATH', 'upper'),
  ('m2-2-1', '平方根與近似值', 4, true, 'J2-MATH', 'upper'),
  ('m2-2-2', '根式的運算', 5, true, 'J2-MATH', 'upper'),
  ('m2-2-3', '畢氏定理', 6, true, 'J2-MATH', 'upper'),
  ('m2-3-1', '利用提公因式與乘法公式做因式分解', 7, true, 'J2-MATH', 'upper'),
  ('m2-3-2', '利用十字交乘法做因式分解', 8, true, 'J2-MATH', 'upper'),
  ('m2-4-1', '因式分解解一元二次方程式', 9, true, 'J2-MATH', 'upper'),
  ('m2-4-2', '配方法與公式解', 10, true, 'J2-MATH', 'upper'),
  ('m2-4-3', '應用問題', 11, true, 'J2-MATH', 'upper'),
  ('m2-5-1', '資料整理與統計圖表', 12, true, 'J2-MATH', 'upper')
ON CONFLICT (id) DO UPDATE SET
  title = EXCLUDED.title,
  sort_order = EXCLUDED.sort_order,
  is_active = EXCLUDED.is_active,
  grade_id = EXCLUDED.grade_id,
  term = EXCLUDED.term;

-- 2) 題型（依技能樹）
INSERT INTO question_types (id, chapter_id, name, code, description, sort_order, is_active)
VALUES
  -- 1-1 乘法公式
  ('m2-1-1-1', 'm2-1-1', '乘法公式的基本型態', 'S01', '理解常見三種乘法公式：(1) (a+b)² = a² + 2ab + b²；(2) (a−b)² = a² − 2ab + b²；(3) (a+b)(a−b) = a² − b²。', 1, true),
  ('m2-1-1-2', 'm2-1-1', '辨認何時適用乘法公式', 'S02', '能辨認形如 (x+3)²、(2x−5)²、(x+4)(x−4) 等可直接套用乘法公式的結構。', 2, true),
  ('m2-1-1-3', 'm2-1-1', '正確套用平方公式展開', 'S03', '能將 (ax+b)² 正確展開為 a²x² + 2abx + b²，並處理好係數與符號。', 3, true),
  ('m2-1-1-4', 'm2-1-1', '差平方公式展開與反向辨識', 'S04', '能將 (a+b)(a−b) 展成 a²−b²，並能由 a²−b² 辨識可以反向寫成 (a+b)(a−b)。', 4, true),
  ('m2-1-1-5', 'm2-1-1', '利用乘法公式快速心算', 'S05', '能利用 (a+b)(a−b) 或 (a±b)² 快速計算如 19×21、(101)² 這類接近整十或整百的數。', 5, true),
  ('m2-1-1-6', 'm2-1-1', '將一般二次多項式配成乘法公式形式', 'S06', '能將 x² + 6x + 9、4x² − 12x + 9 等多項式，辨識並改寫為 (x+3)²、(2x−3)² 等形式。', 6, true),

  -- 1-2 多項式與其加減運算
  ('m2-1-2-1', 'm2-1-2', '單項式、多項式與次數', 'S01', '理解單項式為數字與變數乘積；多項式為若干單項式的和；最高次方決定多項式的次數。', 1, true),
  ('m2-1-2-2', 'm2-1-2', '同類項與不同類項', 'S02', '理解同類項是指變數部分完全相同（包含每個變數的次方），係數可不同。', 2, true),
  ('m2-1-2-3', 'm2-1-2', '排列多項式（標準形式）', 'S03', '能將多項式依次數由高到低排列，並整理出整齊的標準形式。', 3, true),
  ('m2-1-2-4', 'm2-1-2', '多項式加法：合併同類項', 'S04', '能將兩個多項式相加，將同類項的係數相加，變數部分保持不變。', 4, true),
  ('m2-1-2-5', 'm2-1-2', '多項式減法：注意括號與負號', 'S05', '在多項式相減時，能正確將第二個多項式整體加負號或括號展開後再合併同類項。', 5, true),
  ('m2-1-2-6', 'm2-1-2', '用多項式表示幾何周長或面積', 'S06', '能利用多項式表示含未知長度的圖形周長、面積等，並進行加減整理。', 6, true),

  -- 1-3 單項式的乘除運算
  ('m2-1-3-1', 'm2-1-3', '單項式的結構與指數規則', 'S01', '理解單項式由係數與一個或多個變數乘積組成，變數指數為非負整數，乘法時指數相加、除法時指數相減。', 1, true),
  ('m2-1-3-2', 'm2-1-3', '單項式乘法：係數相乘、指數相加', 'S02', '能對單項式做乘法，正確處理數字係數與相同底數的指數相加。', 2, true),
  ('m2-1-3-3', 'm2-1-3', '單項式除法：係數相除、指數相減', 'S03', '能在整除情況下，對單項式做除法，正確處理係數約分與指數相減。', 3, true),
  ('m2-1-3-4', 'm2-1-3', '整數倍與倍數關係的表示', 'S04', '能用單項式乘法表示「某量是另一量的幾倍」，例如 3A 表示 A 的 3 倍。', 4, true),
  ('m2-1-3-5', 'm2-1-3', '應用在幾何公式中的單項式運算', 'S05', '能在使用周長、面積、體積公式時，正確處理單項式的乘除，如矩形面積 = 長×寬。', 5, true),

  -- 2-1 平方根與近似值
  ('m2-2-1-1', 'm2-2-1', '平方與平方根的概念', 'S01', '理解若 a² = b，則 a 為 b 的平方根；正數 b 通常有兩個平方根 ±√b。', 1, true),
  ('m2-2-1-2', 'm2-2-1', '平方根的主值（算式中的 √b）', 'S02', '理解算式中的 √b 代表「非負的平方根」，例如 √9 = 3 而非 ±3。', 2, true),
  ('m2-2-1-3', 'm2-2-1', '平方根的大小比較與數線位置', 'S03', '能估計 √2、√3 等無理數約介於哪兩個整數之間，並在數線上大致定位。', 3, true),
  ('m2-2-1-4', 'm2-2-1', '計算整數的平方根', 'S04', '能對完全平方數（如 4, 9, 16, 25, 36…）找出其平方根。', 4, true),
  ('m2-2-1-5', 'm2-2-1', '平方根的近似值與四捨五入', 'S05', '能利用夾擠法或估算法，求出平方根的近似值，並依指定小數位數做四捨五入。', 5, true),
  ('m2-2-1-6', 'm2-2-1', '利用平方根估計實際長度', 'S06', '能在幾何情境（如對角線長度）中，使用平方根表達並估計實際長度。', 6, true),

  -- 2-2 根式的運算
  ('m2-2-2-1', 'm2-2-2', '根式與最簡根式', 'S01', '理解形如 √a（a>0）的數稱為根式，最簡根式要求被開根號的數不含平方因數且分母不含根號。', 1, true),
  ('m2-2-2-2', 'm2-2-2', '根式的化簡（提取平方因數）', 'S02', '能將 √ab 型根式化簡為 √(k²·m) = k√m 的形式，例如 √20 = 2√5。', 2, true),
  ('m2-2-2-3', 'm2-2-2', '同類根式的加減', 'S03', '能對係數相加減、根號部分相同的根式作加減，如 3√2+5√2=8√2。', 3, true),
  ('m2-2-2-4', 'm2-2-2', '根式的乘除與分母有理化', 'S04', '能運用 √a·√b = √(ab)，以及分母有根號時，乘以「根號自身」或共軛根式使分母有理化。', 4, true),
  ('m2-2-2-5', 'm2-2-2', '含根式的幾何公式運用', 'S05', '在周長、面積或對角線公式中正確處理含根式運算，並將結果化為最簡根式或近似值。', 5, true),

  -- 2-3 畢氏定理
  ('m2-2-3-1', 'm2-2-3', '畢氏定理的敘述', 'S01', '理解在直角三角形中，斜邊長的平方等於兩股長平方和：c² = a² + b²。', 1, true),
  ('m2-2-3-2', 'm2-2-3', '畢氏定理的逆定理', 'S02', '理解若三邊長滿足 c² = a² + b²，則此三角形為直角三角形。', 2, true),
  ('m2-2-3-3', 'm2-2-3', '利用畢氏定理解斜邊長', 'S03', '已知兩股長時，能利用 c² = a² + b² 求出斜邊長。', 3, true),
  ('m2-2-3-4', 'm2-2-3', '利用畢氏定理求股長', 'S04', '已知斜邊與一股長時，能利用 a² = c² − b² 求出另一股長。', 4, true),
  ('m2-2-3-5', 'm2-2-3', '畢氏定理在實際距離與對角線中的應用', 'S05', '能運用畢氏定理解決斜坡長度、對角線長度、最短距離等實際生活問題。', 5, true),

  -- 3-1 利用提公因式與乘法公式做因式分解
  ('m2-3-1-1', 'm2-3-1', '因式與因式分解的意義', 'S01', '理解因式為乘積中的一部分，因式分解是將多項式寫成數個因式的乘積。', 1, true),
  ('m2-3-1-2', 'm2-3-1', '提公因式法', 'S02', '能找出多項式各項的最大公因式，提出後用括號保留剩餘多項式。', 2, true),
  ('m2-3-1-3', 'm2-3-1', '套用平方公式做因式分解', 'S03', '能將 a² + 2ab + b² 型多項式寫成 (a+b)²；a² − 2ab + b² 寫成 (a−b)²。', 3, true),
  ('m2-3-1-4', 'm2-3-1', '差平方公式因式分解', 'S04', '能將 a² − b² 型多項式因式分解為 (a+b)(a−b)。', 4, true),
  ('m2-3-1-5', 'm2-3-1', '混合運用提公因式與乘法公式', 'S05', '能先提公因式後，再對括號內多項式使用平方公式或差平方公式做進一步分解。', 5, true),

  -- 3-2 利用十字交乘法做因式分解
  ('m2-3-2-1', 'm2-3-2', '一般二次三項式 ax²+bx+c 的結構', 'S01', '理解二次三項式的三個係數 a、b、c，並知道因式分解的目標是寫成 (px+q)(rx+s)。', 1, true),
  ('m2-3-2-2', 'm2-3-2', '十字交乘法的思路', 'S02', '理解透過找出兩數，使得乘積為 ac、和為 b，來完成因式分解的基本想法。', 2, true),
  ('m2-3-2-3', 'm2-3-2', 'a=1 情形的十字交乘（簡單因式分解）', 'S03', '在 x²+bx+c 型中，能找出兩數 p、q 使 p+q=b 且 pq=c，並寫成 (x+p)(x+q)。', 3, true),
  ('m2-3-2-4', 'm2-3-2', 'a≠1 情形的十字交乘', 'S04', '在 ax²+bx+c 型中，能用十字交乘法找到適當組合，寫成 (px+q)(rx+s)。', 4, true),
  ('m2-3-2-5', 'm2-3-2', '選擇適當方法進行因式分解', 'S05', '能根據多項式型態選擇使用提公因式、乘法公式或十字交乘法。', 5, true),

  -- 4-1 因式分解解一元二次方程式
  ('m2-4-1-1', 'm2-4-1', '零乘積性質', 'S01', '理解若 AB=0，則 A=0 或 B=0，可用於由因式分解求一元二次方程式的解。', 1, true),
  ('m2-4-1-2', 'm2-4-1', '先整理成標準形式再因式分解', 'S02', '能將方程式整理為 ax²+bx+c=0 的形式，才進一步因式分解。', 2, true),
  ('m2-4-1-3', 'm2-4-1', '利用因式分解解簡單二次方程式', 'S03', '對於可輕易因式分解的方程式，能先拆因式，再利用零乘積性質求解。', 3, true),
  ('m2-4-1-4', 'm2-4-1', '檢查解是否滿足原方程式', 'S04', '將求得的每一個解代回原方程式，確認左右兩邊是否相等，以避免整理過程出錯。', 4, true),
  ('m2-4-1-5', 'm2-4-1', '由解反推方程式', 'S05', '已知二次方程式的兩個解，能反推最簡形式的方程式，例如解為 r,s 時方程式為 (x−r)(x−s)=0。', 5, true),

  -- 4-2 配方法與公式解
  ('m2-4-2-1', 'm2-4-2', '配方法的目標：完成平方', 'S01', '理解配方法是將 ax²+bx+c 轉寫為 (x+p)²=q 之形式，再利用平方根求解。', 1, true),
  ('m2-4-2-2', 'm2-4-2', 'a=1 時配方法的具體步驟', 'S02', '對 x²+bx+c=0，能完成：x²+bx = −c → x²+bx+(b/2)² = (b/2)²−c → (x+b/2)² = (b/2)²−c。', 2, true),
  ('m2-4-2-3', 'm2-4-2', '公式法的推導觀念', 'S03', '知道公式法 x = (−b±√(b²−4ac)) / (2a) 來源於對 ax²+bx+c=0 使用配方法。', 3, true),
  ('m2-4-2-4', 'm2-4-2', '正確代入公式法求解', 'S04', '能正確代入 a,b,c 到公式中，計算判別式 Δ，再求出兩根或一根。', 4, true),
  ('m2-4-2-5', 'm2-4-2', '判別式與解的型態', 'S05', '理解 Δ>0 有兩相異實根；Δ=0 有一重根；Δ<0 無實數根。', 5, true),
  ('m2-4-2-6', 'm2-4-2', '在不同情況下選擇配方法或公式法', 'S06', '能根據方程式形式與數字大小，選擇用配方法或公式法，例如係數簡單適合配方，係數複雜用公式法。', 6, true),

  -- 4-3 應用問題
  ('m2-4-3-1', 'm2-4-3', '從語文敘述判斷是否需要二次方程式', 'S01', '能根據題目中出現的面積、乘積、平方、速度改變等線索，判斷問題是否適合用一元二次方程式建模。', 1, true),
  ('m2-4-3-2', 'm2-4-3', '幾何長寬與面積問題建模', 'S02', '能將長度、寬度以 x 表示，面積寫成二次式，並列成方程式求解。', 2, true),
  ('m2-4-3-3', 'm2-4-3', '行程與拋射問題建模', 'S03', '能將速度、時間、距離的關係或拋物線高度情境寫成二次方程式並求解。', 3, true),
  ('m2-4-3-4', 'm2-4-3', '利用二次方程式解數學文字綜合問題', 'S04', '能解決同時含「和、差、積、比」等條件的二數或三數問題，並選擇合理解。', 4, true),
  ('m2-4-3-5', 'm2-4-3', '檢查並解釋解的合理性', 'S05', '能用文字說明為什麼某個解不符合情境（如長度不能為負、時間不能為 0 以下）。', 5, true),

  -- 5-1 資料整理與統計圖表
  ('m2-5-1-1', 'm2-5-1', '次數分配與組距選擇', 'S01', '理解如何根據資料範圍與筆數選擇適當組數與組距，並建立次數分配表。', 1, true),
  ('m2-5-1-2', 'm2-5-1', '累積次數與累積相對次數的解讀', 'S02', '理解累積次數代表「小於或等於某一界線值的人數」，累積相對次數則代表對應比例。', 2, true),
  ('m2-5-1-3', 'm2-5-1', '從原始資料整理到次數分配表', 'S03', '能從一串原始資料中，依照設定組距統計各組次數，完成次數分配表。', 3, true),
  ('m2-5-1-4', 'm2-5-1', '由次數表計算累積次數與相對次數', 'S04', '能在次數分配表中加入「累積次數」與「相對次數、累積相對次數」欄位。', 4, true),
  ('m2-5-1-5', 'm2-5-1', '繪製折線圖與累積折線圖', 'S05', '能根據次數或累積次數資料，選擇適當座標（如組上限）作為 x 軸，繪製折線圖或累積折線圖。', 5, true),
  ('m2-5-1-6', 'm2-5-1', '由統計圖表回答「小於／至少」等問題', 'S06', '能利用表格或圖形求出「小於某值」「至少某值」的人數與比例。', 6, true),
  ('m2-5-1-7', 'm2-5-1', '比較兩組資料的成績分布', 'S07', '能用累積折線圖比較兩班高分比例、集中程度、分布情形。', 7, true)
ON CONFLICT (id) DO UPDATE SET
  chapter_id = EXCLUDED.chapter_id,
  name = EXCLUDED.name,
  code = EXCLUDED.code,
  description = EXCLUDED.description,
  sort_order = EXCLUDED.sort_order,
  is_active = EXCLUDED.is_active;


